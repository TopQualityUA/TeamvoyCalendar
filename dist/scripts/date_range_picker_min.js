define("calendar_templates",[],function(){"use strict";var e=function(){return this};return e.prototype={templates:{dayTemplate:"<div class='calendar__day'>{{day}}</div>",dayNameTemplate:"<div class='calendar__day-name'>{{day_name}}</div>",calendarTemplate:"<div class='calendar'><div class='calendar__caption'><button class='calendar__prev-month'></button><button class='calendar__next-month'></button><div class='calendar__month-and-year'><span class='calendar__month-name'>{Month Name}</span><span class='calendar__year-name'>{Year Name}</span></div></div><div class='calendar__header'></div><div class='calendar__body'></div></div>"},_parseLineIntoDOMElement:function(e){var t,n=document.createElement("body"),a=document.createDocumentFragment();for(n.innerHTML=e;n.firstChild;)t=n.firstChild,a.appendChild(t);return a.childNodes[0]},dayTemplate:function(e){var t=this._parseLineIntoDOMElement(this.templates.dayTemplate.toString());return t.date=e.date,t.classList.add(e.isInMonth?"calendar__day--in-month":"calendar__day--out-month"),e.isWeekend&&t.classList.add("calendar__day--weekend"),e.isToday&&t.classList.add("calendar__day--today"),t.innerHTML=e.date.getDate().toString(),t},dayNameTemplate:function(e){var t=this._parseLineIntoDOMElement(this.templates.dayNameTemplate.toString());return t.dayName=e.name,e.isWeekend&&t.classList.add("calendar__day-name--weekend"),t.innerHTML=e.name,t},calendarTemplate:function(){return this._parseLineIntoDOMElement(this.templates.calendarTemplate.toString())}},e}),define("event_machine",[],function(){"use strict";var e=function(){var e={};this.on=function(t,n){return t.split(/\s+/).forEach(function(t){e[t]?0:e[t]=[],e[t].push(n)}),this},this.off=function(t,n){return t.split(/\s+/).forEach(function(t){e[t]&&(e[t]=e[t].filter(function(e){return!(e===n)}))}),this},this.trigger=function(t,n){var a=this;return t.split(/\s+/).forEach(function(t){e[t]&&e[t].forEach(function(e){e.apply(a,n)})}),this}};return e}),define("calendar_helper",[],function(){"use strict";Element.prototype.deleteAllChildNodes=function(){for(;this.firstChild;)this.removeChild(this.firstChild);return this}}),define("calendar",["calendar_templates","event_machine","moment","calendar_helper"],function(e,t,n){"use strict";function a(e){var t=n([e.year,e.month-1,1]);return t.isAfter(t.clone().day(e.firstDayOfWeek))?t.day(e.firstDayOfWeek):t.day(e.firstDayOfWeek).subtract(7,"days")}function r(e,t,a){return Array.apply(null,{length:t}).map(function(){var t=e.clone().locale("en").format("ddd"),r={isInMonth:e.get("month")===a.month-1,isWeekend:-1!==a.weekends.indexOf(t),isToday:n().startOf("day").diff(e,"days")?!1:!0,date:e.clone().toDate()};return e.add(1,"days"),r})}function d(e,t){return Array.apply(null,{length:t.daysInWeek}).map(function(){var n={name:e.format("ddd"),isWeekend:-1!==t.weekends.indexOf(e.clone().locale("en").format("ddd"))};return e.add(1,"days"),n})}var o=new e,s=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]||(e[n]=[]),e[n]=t[n]);return e},i=function(e,a){function r(){i.addEventListener("click",function(e){e.target.classList.contains("calendar__next-month")||e.target.classList.contains("calendar__prev-month")?(e.target.classList.contains("calendar__next-month")?c.nextMonth():c.previousMonth(),c.trigger("monthChanged",[l.month])):e.target.date&&c.trigger("daySelected",[e.target.date])})}function d(){return i=o.calendarTemplate(),e.appendChild(i),l=s(l,a),u=c.generateModel(l),c.render(),r(),c.trigger("load",[c]),c}t.call(this),n=n||window.moment,n.locale("en");var i,c=this,l={year:(new Date).getFullYear(),month:(new Date).getMonth()+1,firstDayOfWeek:"SUN",locale:"en",daysInWeek:7,weekends:["Sat","Sun"]},u={daysNames:[],days:[],currentMonth:""};this.getRoot=function(){return i},this.set=function(e,t){var n=s({},l);n[e]=t,u=c.generateModel(n),l=s(l,n),c.render()},this.get=function(e){return e?l[e]:l},this.nextMonth=function(){12===l.month&&(l.year=(parseFloat(l.year)+1).toString()),c.set("month",l.month.valueOf()%12+1)},this.previousMonth=function(){1===l.month?(l.year=(parseFloat(l.year)-1).toString(),c.set("month",12)):c.set("month",(l.month.valueOf()-1)%12)},this.setConfig=function(e){var t=s(s({},l),e);u=c.generateModel(t),l=s(l,e),c.render()},this.getConfig=function(){return l},this.render=function(){return c.renderCaption(l,u),i.querySelector(".calendar__header").deleteAllChildNodes().appendChild(c.renderHeader(l,u)),i.querySelector(".calendar__body").deleteAllChildNodes().appendChild(c.renderBody(u)),c.trigger("render",[c]),c},this.showToday=function(){var e,t=n().locale(l.locale);return l.month=t.get("month")+1,l.year=t.get("year"),u=c.generateModel(l),c.render(),Array.prototype.slice.call(i.querySelector(".calendar__body").childNodes).some(function(a){return e=n(a.date).locale(l.locale),0===t.diff(e,"days")?!a.classList.add("today"):void 0}),t.toDate()},d()};return i.prototype.generateModel=function(e){var t=a(e).locale(e.locale),o={},s=(1+parseFloat(Math.ceil(30/e.daysInWeek)))*e.daysInWeek;if(!t.isValid())throw"Date validation error: "+t.invalidAt();return o.daysNames=d(t.clone(),e),o.currentMonth=n().set("month",e.month-1).format("MMMM"),o.days=r(t,s,e),o},i.prototype.renderCaption=function(e,t){this.getRoot().querySelector(".calendar__month-name").innerHTML=t.currentMonth.toString(),this.getRoot().querySelector(".calendar__year-name").innerHTML=e.year.toString()},i.prototype.renderHeader=function(e,t){if(e.daysInWeek/7-Math.floor(e.daysInWeek/7)===0){var n=document.createDocumentFragment();return t.daysNames.map(function(e){n.appendChild(o.dayNameTemplate(e))}),n}},i.prototype.renderBody=function(e){var t=document.createDocumentFragment();return e.days.forEach(function(e){t.appendChild(o.dayTemplate(e))}),t},i}),define("date_range_picker",["calendar","calendar_templates","event_machine","moment","calendar_helper"],function(e,t,n,a){"use strict";var r=function(t,r,d,o){function s(e){var t,n=e.getRoot().querySelector(".calendar__body");return Array.prototype.slice.call(n.childNodes).forEach(function(e){t=a(e.date),t.isAfter(h.start)&&t.isBefore(h.end)&&e.classList.add("calendar__day--selected"),t.calendar()===h.start.calendar()&&e.classList.add("calendar__day--selected--start"),t.calendar()===h.end.calendar()&&e.classList.add("calendar__day--selected--end")}),m}function i(e,t){var n,r;e.preventDefault(),e.target.date&&(n=h.end.diff(h.start),r=a(e.target.date),"start"===t?r.calendar()!==h.end.calendar()&&(h.end=r.clone(),r.isBefore(h.start)&&(h.start=h.end.clone().subtract(n,"milliseconds")),m.render(),m.trigger("rangeChanged",[h.start.clone().toDate(),h.end.clone().toDate()])):r.calendar()!==h.start.calendar()&&(h.start=r.clone(),r.isAfter(h.end)&&(h.end=h.start.clone().add(n,"milliseconds")),m.render(),m.trigger("rangeChanged",[h.start.clone().toDate(),h.end.clone().toDate()])))}function c(){function e(e){i(e,"start")}function t(e){i(e,"end")}function n(){m.configMonthAndYear(),m.renderSelectedDays(),document.removeEventListener("mousemove",e),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",n)}m.startCalendar.getRoot().addEventListener("mousedown",function(e){e.target.date&&(i(e,"end"),document.addEventListener("mousemove",t),document.addEventListener("mouseup",n))}),m.endCalendar.getRoot().addEventListener("mousedown",function(t){t.target.date&&(i(t,"start"),document.addEventListener("mousemove",e),document.addEventListener("mouseup",n))}),m.startCalendar.on("render",m.renderSelectedDays),m.endCalendar.on("render",m.renderSelectedDays)}function l(){u=document.createElement("div"),u.classList.add("date-range-picker"),m.startCalendar=new e(u,o),m.endCalendar=new e(u,o),h=m.changeRange(r,d),h.start.format("LLL"),h.end.format("LLL"),t.appendChild(u),m.startCalendar.getRoot().classList.add("calendar--date-range-picker--start"),m.endCalendar.getRoot().classList.add("calendar--date-range-picker--end"),m.renderSelectedDays(),c(),m.trigger("load",[m])}n.call(this),a=a||window.moment,a.locale("en");var u,h={start:a(),end:a()},m=this;this.getRoot=function(){return u},this.getRange=function(){return{start:h.start.toDate(),end:h.end.toDate()}},this.setStartDate=function(e){h.start=a(new Date(e))||h.start,m.configMonthAndYear(),m.render(),m.trigger("rangeChanged",[h.start.toDate(),h.end.toDate()])},this.setEndDate=function(e){h.end=a(new Date(e))||h.end,m.configMonthAndYear(),m.render(),m.trigger("rangeChanged",[h.start.toDate(),h.end.toDate()])},this.changeRange=function(e,t){return e&&t&&(h={start:a(new Date(e))||h.start,end:a(new Date(t))||h.end},m.configMonthAndYear(),m.render(),m.trigger("rangeChanged",[h.start.toDate(),h.end.toDate()])),h},this.renderSelectedDays=function(){s(m.startCalendar),s(m.endCalendar)},this.render=function(){m.startCalendar.render(),m.endCalendar.render(),m.renderSelectedDays()},this.configMonthAndYear=function(){m.startCalendar.setConfig({month:h.start.get("month")+1,year:h.start.get("year")}),m.endCalendar.setConfig({month:h.end.get("month")+1,year:h.end.get("year")})},l.call(this)};return r});