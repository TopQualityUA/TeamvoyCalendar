define("calendar_templates",[],function(){"use strict";var e=function(){return this};return e.prototype={templates:{dayTemplate:"<div class='calendar__day'>{{day}}</div>",dayNameTemplate:"<div class='calendar__day-name'>{{day_name}}</div>",calendarTemplate:"<div class='calendar'><div class='calendar__caption'><button class='calendar__prev-month'></button><button class='calendar__next-month'></button><div class='calendar__month-and-year'><span class='calendar__month-name'>{Month Name}</span><span class='calendar__year-name'>{Year Name}</span></div></div><div class='calendar__header'></div><div class='calendar__body'></div></div>"},_parseLineIntoDOMElement:function(e){var t,n=document.createElement("body"),a=document.createDocumentFragment();for(n.innerHTML=e;n.firstChild;)t=n.firstChild,a.appendChild(t);return a.childNodes[0]},dayTemplate:function(e){var t=this._parseLineIntoDOMElement(this.templates.dayTemplate.toString());return t.date=e.date,t.classList.add(e.isInMonth?"calendar__day--in-month":"calendar__day--out-month"),e.isWeekend&&t.classList.add("calendar__day--weekend"),e.isToday&&t.classList.add("calendar__day--today"),t.innerHTML=e.date.getDate().toString(),t},dayNameTemplate:function(e){var t=this._parseLineIntoDOMElement(this.templates.dayNameTemplate.toString());return t.dayName=e.name,e.isWeekend&&t.classList.add("calendar__day-name--weekend"),t.innerHTML=e.name,t},calendarTemplate:function(){return this._parseLineIntoDOMElement(this.templates.calendarTemplate.toString())}},e}),define("event_machine",[],function(){"use strict";var e=function(){var e={};this.on=function(t,n){return t.split(/\s+/).forEach(function(t){e[t]?0:e[t]=[],e[t].push(n)}),this},this.off=function(t,n){return t.split(/\s+/).forEach(function(t){e[t]&&(e[t]=e[t].filter(function(e){return!(e===n)}))}),this},this.trigger=function(t,n){var a=this;return t.split(/\s+/).forEach(function(t){e[t]&&e[t].forEach(function(e){e.apply(a,n)})}),this}};return e}),define("calendar_helper",[],function(){"use strict";Element.prototype.deleteAllChildNodes=function(){for(;this.firstChild;)this.removeChild(this.firstChild);return this}}),define("calendar",["calendar_templates","event_machine","moment","calendar_helper"],function(e,t,n){"use strict";function a(e){var t=n([e.year,e.month-1,1]);return t.isAfter(t.clone().day(e.firstDayOfWeek))?t.day(e.firstDayOfWeek):t.day(e.firstDayOfWeek).subtract(7,"days")}function r(e,t,a){return Array.apply(null,{length:t}).map(function(){var t=e.clone().locale("en").format("ddd"),r={isInMonth:e.get("month")===a.month-1,isWeekend:-1!==a.weekends.indexOf(t),isToday:n().startOf("day").diff(e,"days")?!1:!0,date:e.clone().toDate()};return e.add(1,"days"),r})}function o(e,t){return Array.apply(null,{length:t.daysInWeek}).map(function(){var n={name:e.format("ddd"),isWeekend:-1!==t.weekends.indexOf(e.clone().locale("en").format("ddd"))};return e.add(1,"days"),n})}var d=new e,i=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]||(e[n]=[]),e[n]=t[n]);return e},s=function(e,a){function r(){s.addEventListener("click",function(e){e.stopPropagation(),e.target.classList.contains("calendar__next-month")||e.target.classList.contains("calendar__prev-month")?(e.target.classList.contains("calendar__next-month")?l.nextMonth():l.previousMonth(),l.trigger("monthChanged",[c.month])):e.target.date&&l.trigger("daySelected",[e.target.date])})}function o(){return s=d.calendarTemplate(),e.appendChild(s),c=i(c,a),u=l.generateModel(c),l.render(),r(),l.trigger("load",[l]),l}t.call(this),n=n||window.moment,n.locale("en");var s,l=this,c={year:(new Date).getFullYear(),month:(new Date).getMonth()+1,firstDayOfWeek:"SUN",locale:"en",daysInWeek:7,weekends:["Sat","Sun"]},u={daysNames:[],days:[],currentMonth:""};this.getRoot=function(){return s},this.set=function(e,t){var n=i({},c);n[e]=t,u=l.generateModel(n),c=i(c,n),l.render()},this.get=function(e){return e?c[e]:c},this.nextMonth=function(){12===c.month&&(c.year=(parseFloat(c.year)+1).toString()),l.set("month",c.month.valueOf()%12+1)},this.previousMonth=function(){1===c.month?(c.year=(parseFloat(c.year)-1).toString(),l.set("month",12)):l.set("month",(c.month.valueOf()-1)%12)},this.setConfig=function(e){var t=i(i({},c),e);u=l.generateModel(t),c=i(c,e),l.render()},this.getConfig=function(){return c},this.render=function(){return l.renderCaption(c,u),s.querySelector(".calendar__header").deleteAllChildNodes().appendChild(l.renderHeader(c,u)),s.querySelector(".calendar__body").deleteAllChildNodes().appendChild(l.renderBody(u)),l.trigger("render",[l]),l},this.showToday=function(){var e,t=n().locale(c.locale);return c.month=t.get("month")+1,c.year=t.get("year"),u=l.generateModel(c),l.render(),Array.prototype.slice.call(s.querySelector(".calendar__body").childNodes).some(function(a){return e=n(a.date).locale(c.locale),0===t.diff(e,"days")?!a.classList.add("today"):void 0}),t.toDate()},o()};return s.prototype.generateModel=function(e){var t=a(e).locale(e.locale),d={},i=(1+parseFloat(Math.ceil(30/e.daysInWeek)))*e.daysInWeek;if(!t.isValid())throw"Date validation error: "+t.invalidAt();return d.daysNames=o(t.clone(),e),d.currentMonth=n().set("month",e.month-1).format("MMMM"),d.days=r(t,i,e),d},s.prototype.renderCaption=function(e,t){this.getRoot().querySelector(".calendar__month-name").innerHTML=t.currentMonth.toString(),this.getRoot().querySelector(".calendar__year-name").innerHTML=e.year.toString()},s.prototype.renderHeader=function(e,t){if(e.daysInWeek/7-Math.floor(e.daysInWeek/7)===0){var n=document.createDocumentFragment();return t.daysNames.map(function(e){n.appendChild(d.dayNameTemplate(e))}),n}},s.prototype.renderBody=function(e){var t=document.createDocumentFragment();return e.days.forEach(function(e){t.appendChild(d.dayTemplate(e))}),t},s});